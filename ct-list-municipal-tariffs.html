<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-input/paper-input-behavior.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../iron-icons/social-icons.html">
<link rel="import" href="../iron-form/iron-form.html">

<!--
`ct-list-municipal-tariffs`
Element to display a filterable list of municipal tariffs

@demo demo/index.html
-->

<dom-module id="ct-list-municipal-tariffs">
  <template>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <style is="custom-style" include="global-styles">
      :host {

        display: block;

        --paper-input-container:  {
          border-top:1px solid #ccc;
          border-left:1px solid #ccc;
          border-right:1px solid #ccc;
          border-bottom: none;
          padding: 0;
        };

        /*padding to move from border */


        --paper-input-container-label: {
          margin-left: 10px;
        };
        --paper-input-container-label-floating: {
          margin-left: 10px;
        };


        --paper-input-error: {
          left: auto !important;
          right: 20px !important;
          font-style: italic;
        };

      }

      .main-section {
        margin-top:20px;
      }


      iron-icon.user-online{
        --iron-icon-fill-color:{#4d96bb;};

      }
      /*local dropdown menu */
      paper-menu {
        width: 400px;
      }
      paper-dropdown-menu.custom-dropdown {
        width: 100%;
        --paper-input-container: {
          border-top:1px solid #ccc;
          border-left:1px solid #ccc;
          border-right:1px solid #ccc;
          border-bottom: none;
          padding: 0;
          margin-bottom: 8px;
        };
        --paper-input-container-input: {
          padding-left: 10px;
        };
      }

    </style>
    <div class="main-section">
      <div class="container-fluid">

        <div class="row">
          <div class="col-xs-6">
            <paper-dropdown-menu class="custom-dropdown" label="Meter  Types" always-float-label noink no-animations>
              <paper-listbox class="dropdown-content" selected="{{_selectedMeterType}}" attr-for-selected="key">
                <paper-item key="0">All</paper-item>
                <template is="dom-repeat" items="{{meterTypes}}">
                  <paper-item key="[[item.id]]">[[item.name]]</paper-item>
                </template>
              </paper-listbox>
            </paper-dropdown-menu>
          </div>
          <div class="col-xs-6">
            <paper-button class="fancy margin-10v btn btn-default btn btn-primary" width="80px" raised on-tap="_newMunicipality">Add Municipality</paper-button>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-12">
            <template is="dom-if" if="{{_computeHasData(municipalityList)}}">
              <div class="table-responsive">
                <table class="table table-striped table-bordered table-hover table-middle">
                  <thead>
                  <th>Municipality Name</th>
                  <th>Utility Type</th>
                  <th>Action</th>
                  </thead>
                  <tbody>

                  <template is="dom-repeat" items="{{municipalityList}}">
                    <tr>
                      <td>[[item.name]]</td>
                      <td>[[item.utilityType]]</td>
                      <td class="text-center"><paper-button class="table-button btn-primary btn-sm" on-tap="_viewSingleMunicipality" raised>View</paper-button></td>
                    </tr>
                  </template>

                  </tbody>
                </table>
              </div>
              <div class="col-xs-12">
                <nav aria-label="Page navigation">
                  <mercury-paginator perpage="50" items="{{municipalityList}}"></mercury-paginator>
                </nav>
              </div>
            </template>

            <template is="dom-if" if="{{!_computeHasData(municipalityList)}}">
              <div><p class="text-center">No Municipalities to display</p></div>
            </template>

          </div>

        </div>
      </div>
    </div>
  </template>

  <script>
      Polymer({

          is: 'ct-list-municipal-tariffs',

          properties: {
              municipalityList : Array,
              meterTypes : Array,
              _selectedMeterType: {
                  type: Number,
                  value: function(){ return 0; }
              }
          },

          _viewSingleMunicipality : function(e) {

              if(e.model && e.model.item.id){
                  this.fire('viewMunicipality', e.model.item.id);
              } else {
                  this.fire('toast', {message: 'Cannot display municipalities', type: 'danger'});
              }

          },

          _computeHasData : function(list){
              return (list.length > 0);
          },


          _newMunicipality : function(){
              this.fire('newMunicipality');
          }

      });
  </script>
</dom-module>
